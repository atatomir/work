Solutie Undo – Daniel Posdarascu, Andrei Heidelbacher

Construim un arbore al update-urilor in felul urmator (un arbore in care fiecare nod reprezinta un update): Consideram toate operatiile de Update si Undo insiruite ca un vector. In momentul in care avem la momentul I un Undo x, putem considera ca ultimile x Update-uri si Undo-uri au disparut si suntem pozitionati la update-ul de la timpul I – x. Cand ne vine un update nou, legam update-ul curent de update-ul de la pozitia precedenta. Este clar ca atunci cand ne vine un update nou, la momentul respectiv ne pozitionam la acel update. Dupa ce am construit arborele o sa facem o parcurgere dfs pe el si rezolvam offline toate query-urile. Mai exact, cand suntem intr-un nod facem update-ul, rezolvam toate query-urile din acel nod si continuam mai departe in fii. Cand ne intoarcem in tata scoatem update-ul (updatam acelasi lucru dar cu minus).
